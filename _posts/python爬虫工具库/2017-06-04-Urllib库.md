---
layout: post

title:  "Urllib库"

date:   2017-06-05 18:06:00

categories: python爬虫工具库

---
# Urllib库的使用

<br />

## Urllib库介绍

urllib2是Python的一个**获取URL(Uniform Resource Locator)**的工具库。提供各种函数接口来获取网页中的资源  
**使用前需要先导入**  
```python
import urllib2

url = 'https://www.baidu.com'
response = urllib2.urlopen(url)
print response.read()
```
`urlopen(url, data, timeout)`  
使用该函数可以简单获取网页源码
参数： **url** 统一资源定位符(即网址)，**data**是访问url时要传送的数据，**timeout**是设置超时时间，后两个参数为默认参数。  
返回一个相关请求response对象，可以调用该对象的`.read()`来读取网页源码  

<br />

## Request

**HTTP建基于请求(request)和响应(response)-客户端制造请求服务器返回响应**  
其实在上面调用`urlopen()`的时候将构造Reqeust对象的过程隐去了，可以先构造Request对象在调用`urlopen()`函数  
```python
import urllib2

url = 'https://www.baidu.com'
request = urllib2.Request(url)
response = urllib2.urlopen(request)
print response.read()
```
在构造Request对象时可以传入url，data等参数  
这运行结果和上面的结果完全一样，只是多了个Request对象，**推荐用下面的写法**，在构造Request对象的时候可以加入更多内容，服务器响应请求得到应答，显得逻辑更清晰明确  

<br />

## POST与GET

在HTTP请求的时候，往往很多时候要动态的传递参数，以获取对应的响应  
这时候常用的就有**POST请求**和**GET请求**  
POST请求和GET请求的区别在于GET请求的数据会附在URL之后（就是把数据放置在HTTP协议头中），以?分割URL和传输数据，参数之间以&相连，POST则不会在网址上显示所有的参数  
需要引用**urllib库**把表单的数据以标准的方式encode  

### POST

利用POST请求模拟登陆学校教务系统
```python
import urllib
import urllib2

url = 'http://222.200.98.147/login!doLogin.action'
values = {}
values['account'] = '3116004779'
values['pwd'] = 'xxxxxx'
values['verifycode'] = ''
data = urllib.urlencode(values)
request = urllib2.Request(url, data=data)
response = urllib2.urlopen(request)
print response.read()
```

<br />

### GET

利用GET请求模拟登陆学校教务系统
```python
import urllib
import urllib2

url = 'http://222.200.98.147/login!doLogin.action'
values = {}
values['account'] = '3116004779'
values['pwd'] = 'xxxxxx'
values['verifycode'] = ''
data = urllib.urlencode(values)
geturl = url + '?' + data
request = urllib2.Request(geturl)
response = urllib2.urlopen(request)
print response.read()
```


