---
layout:     post
title:      "生成学习算法"
subtitle:   ""
date:       2017-07-22 10:00:00
author:     "Wes"
header-img: "img/生成学习算法-bg.jpg"
catalog: true
tags:
    - Machine Learning
---

# 生成学习算法（generative learning algorithm）

**生成学习算法**与**判别学习算法**有所不同，后者通过建立输入空间**X**与输出标注**{1, 0}**间的映射关系学习得到**p(y|x)**，你输入一个X，它就输出一个Y，这个Y与一个阈值比较，根据比较结果判定X属于哪个类别，而生成学习算法是对**p(x|y)**和**p(y)**建模，然后根据**贝叶斯公式**，求得**p(y|x)**的最大值进行预测  
就像这个例子，假如我们想要根据一些动物的特征，区分大象**(y=1)**和小狗**(y=0)**，对于已知的训练集，诸如逻辑回归、感知算法基本上都是尝试找到一条直线，也就是判别边界，以区分大象样本和小狗样本，新样本根据这条边界判断新样本的类别  
而对于生成学习算法而言就是，首先观察大象的样本，然后建立一个描述大象的模型；接着，观察小狗样本，建立另一个描述小狗的模型，判断新样本时，先用样本和大象模型做比对，再用样本和小狗模型比对，然后看新样本究竟是更像大象还是更像小狗  
根据贝叶斯公式可以得到  
![](https://wes-lee.github.io/assets/img/生成学习算法/求贝叶斯极大似然.gif)  
**argmax<sub>y</sub>**表示使能够后面跟的式子取的最大值时**y**的值，这个式子的意思是，求给定**x**的条件下，最有可能的**y**，然后因为**p(x)**与**y**无关，所以分母取值不影响式子取得最大值时y的取值，而如果**p(y)**是均匀分布的话，就是**p(y=0)=p(y=1)**，那么就是求**p(x|y)**最大时的**y**  

# 高斯判别分析（Gaussian discriminant analysis）

**高斯判别分析(GDA)**是生成学习算法的一个例子  

## 多元正态分布

在说高斯判别分析前要先讲下多元正态分布，它的概率密度函数如下  
![](https://wes-lee.github.io/assets/img/生成学习算法/多元正态分布.gif)  
其中**μ**为**期望向量**，**Σ**是**协方差矩阵**(这是半正定矩阵)，通常记为**N(μ,Σ)**  
随机向量**Z**定义为  
![](https://wes-lee.github.io/assets/img/生成学习算法/协方差矩阵.gif)  
可以化成下面的式子  
![](https://wes-lee.github.io/assets/img/生成学习算法/协方差矩阵简化.gif)  
这就是多元正态分布一些基本的性质  

## 高斯判别分析模型

现在来考虑这样一个分类问题，它的输入特征**x**为一系列连续取值的随机变量，这时我们就可以使用高斯判别分析模型  
使用多元正态分布对**p(x|y)**建模，有：  
![](https://wes-lee.github.io/assets/img/生成学习算法/高斯判别模型.gif)  
它们的概率密度函数  
![](https://wes-lee.github.io/assets/img/生成学习算法/高斯判别分析模型分布.gif)  
参模型中的参数为**ϕ, Σ, μ0, μ1**（尽管有两个不同的期望**μ0, μ1**，该模型通常也只是使用一个协方差矩阵**Σ**）。参数的对数似然函数为  
![](https://wes-lee.github.io/assets/img/生成学习算法/参数对数似然函数.gif)  
最后通过求最大值可以得到参数的形式  
![](https://wes-lee.github.io/assets/img/生成学习算法/参数似然极大值.gif)  
**Φ是训练样本中结果 y=1 占有的比例**  
**μ0是 y=0 的样本中特征均值**  
**μ1是 y=1 的样本中特征均值**  
**Σ是样本特征方差均值**  

## 高斯判别分析法和逻辑回归

对于高斯判别和逻辑回归，如果把**p(y=1∣x;ϕ,μ0,μ1,Σ)**看成是关于**x**的函数，有  
![](https://wes-lee.github.io/assets/img/生成学习算法/高斯判别和逻辑回归.gif)  
其中**θ**是一个关于**ϕ,μ0,μ1,Σ**的函数，而这就是**logistic函数**，也就是说如果使用高斯判别建模时假设**x|y~Gaussian**，那就可以推导出**p(y|x)**是个**logistic函数**，但是相反的如果**p(y|x)**是个**logistic函数**并不能推出**x|y~Gaussian**  
这就是高斯判别模型和逻辑回归的联系  
那么应该如何选择这两个模型呢，在假设模型正确(或**x|y**大致服从高斯分布)的前提下，同逻辑回归相比，**高斯判别法**能够对数据做出更好的拟合，得到更好的模型  
而**逻辑回归**鲁棒性更好，不需要很强的假设，它对异常模型的假设更加不敏感  
所以如果数据实际上不符合高斯分布，或者不确定**x|y**的分布时，使用**逻辑回归**效果会更好，而在于知道符合高斯分布，且数据量较多时，**高斯判别分析法**会好  
